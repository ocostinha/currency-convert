# Locale Configuration
spring.web.locale=en_US
spring.web.locale-resolver=fixed
#
# H2 Database Configuration
spring.datasource.url=${DB_URL:jdbc:h2:file:./db/codingTest}
spring.datasource.driverClassName=${DB_DRIVER_CLASS_NAME:org.h2.Driver}
spring.datasource.username=${DB_USERNAME:felipepaltrinieri}
spring.datasource.password=${DB_PASSWORD:wex}
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
#
# JPA Configuration
#
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=validate
#
# Flyway Configuration
#
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
#
# Server Configuration
#
server.port=${SERVER_PORT:8080}
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=${SHUTDOWN_TIMEOUT:30s}
#
# FiscalData
#
fiscal.data.base-url=${FISCAL_DATA_BASE_URL:https://api.fiscaldata.treasury.gov/services/api/fiscal_service}
fiscal.data.rates-of-exchange-path=${FISCAL_DATA_RATES_PATH:/v1/accounting/od/rates_of_exchange}
fiscal.data.max-month-ago=${FISCAL_DATA_MAX_MONTH_AGO:6}
fiscal.data.connect-timeout-ms=${FISCAL_DATA_CONNECT_TIMEOUT_MS:5000}
fiscal.data.read-timeout-ms=${FISCAL_DATA_READ_TIMEOUT_MS:10000}
fiscal.data.max-retries=${FISCAL_DATA_MAX_RETRIES:3}
#
# Circuit Breaker
#
resilience4j.circuitbreaker.instances.fiscal-data-service.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.fiscal-data-service.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.instances.fiscal-data-service.sliding-window-size=10
resilience4j.circuitbreaker.instances.fiscal-data-service.minimum-number-of-calls=5
resilience4j.circuitbreaker.instances.fiscal-data-service.record-failure-predicate=costa.paltrinieri.felipe.infrastructure.circuitBreak.CircuitBreakerPredicate
#
# Retry
#
resilience4j.retry.instances.fiscalDataRetry.max-attempts=3
resilience4j.retry.instances.fiscalDataRetry.wait-duration=500ms
resilience4j.retry.instances.fiscalDataRetry.enable-exponential-backoff=true
resilience4j.retry.instances.fiscalDataRetry.exponential-backoff-multiplier=2
#
# Cache
#
spring.cache.type=caffeine
spring.cache.caffeine.spec=expireAfterWrite=1d
#
# Rate Limiting
#
rate.limit.capacity=${RATE_LIMIT_CAPACITY:50}
rate.limit.refill-tokens=${RATE_LIMIT_REFILL_TOKENS:50}
rate.limit.refill-duration-minutes=${RATE_LIMIT_REFILL_DURATION:1}
#
# Actuator
#
management.server.port=${MANAGEMENT_PORT:9090}
management.server.address=127.0.0.1
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.endpoint.health.show-components=always
management.prometheus.metrics.export.enabled=true
management.metrics.tags.application=purchase-transaction-app
management.metrics.distribution.percentiles-histogram.fiscal.data.api.latency=true
#
# OpenAPI/Swagger
#
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
